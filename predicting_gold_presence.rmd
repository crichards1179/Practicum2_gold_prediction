---
title: "predicting_gold_presence"
author: "Matt Twigg"
date: "7/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Introduction  

I will predict gold presence from other minerals

```{r}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(corrplot)
```

```{r}
dn <- read.csv("deadwoodnorth.csv")
ds <- read.csv("deadwoodsouth.csv")
ld <- read.csv("lead.csv")
tn <- read_csv("tinton.csv")
sp <- read_csv("spearfish.csv")
```



```{r}
sites <- rbind(dn, ds, ld, tn, sp)
sites
```




```{r}
s1 <- sites %>% select(
  dep_id,
  latitude,
  longitude,
  commod1,
  commod2,
  commod3,
)
```


```{r}
s2 <- data.frame(s1)
```


```{r}
s2$commod2 <- as.factor(s2$commod2)
```

```{r}
str(s2)
```
```{r}
s2com <- unite(s2, commodities, 4:6, sep = ", ")
#str(s2com)
```
```{r}
au <- str_detect(s2com$commodities, "Gold")
#au
```

```{r}
s2com1 <- cbind(s2com, au)
```

```{r}
reds2com <- subset(s2com1, au == TRUE)
```

```{r}
rownames(reds2com) <- 1:nrow(reds2com)
#reds2com
```


```{r}
colreds2com <- reds2com %>% separate(commodities, c("one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen"), "," ) 
```
```{r}
colSums(is.na(colreds2com))
```
```{r}
reducedcol <- colreds2com %>% select(1:14)
```

```{r}
colSums(is.na(reducedcol))
```

```{r}
#unique(reducedcol$one)
```

```{r}
#unique(reducedcol$two)
```


```{r}
#unique(reducedcol$three)
```

```{r}
noNA <- reducedcol %>% replace_na(list(four = "",  five = "", six  = "", seven  = "", eight  = "", nine = "", ten  = "", eleven  = ""))
noNA[noNA == " NA"] <- ""
#write.csv(noNA1, file = "noNA1.csv")
#noNA

```


```{r}
#out <- unite(noNA, commodities, 4:14, sep = ", ")
#write.csv(out, file = "out.csv")
#out
```
```{r}
imported <- read.csv("in.csv")
imported
```

```{r}
str(imported)
```


```{r}
minerals <- c(colnames(imported[6:27]))
mined <- integer()
#count <- 0
for (names in minerals){
  mined <- c(mined, sum(imported[[names]]))
}
mined
```


```{r}
totals <- data.frame(minerals, mined)
totals
```



```{r}
htot <- as.data.frame(t(totals$mined))
colnames(htot) <- minerals
htot
```

## Visualizations 
```{r}
str(imported)
```


```{r}
corrdf <- imported %>% select(
  7:27
)
corrdf
```

```{r}
corrdfvalues <- cor(corrdf)
```


```{r}
corrplot(corrdfvalues)
```






#####################################################################################

```{r}
mydata = read.csv("https://wiki.q-researchsoftware.com/images/b/b9/Ownership.csv", header = TRUE, fileEncoding="latin1")
mydata
```








